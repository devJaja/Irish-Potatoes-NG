{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useQuery,useMutation,useQueryClient}from'@tanstack/react-query';import{productsAPI,uploadAPI}from'../services/api';import{UploadCloud,X,Loader2}from'lucide-react';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminProducts=()=>{const queryClient=useQueryClient();const[selectedProduct,setSelectedProduct]=useState(null);const[selectedFiles,setSelectedFiles]=useState([]);const[existingImages,setExistingImages]=useState([]);const[isUploading,setIsUploading]=useState(false);// When a product is selected for editing, populate the form and existing images\nuseEffect(()=>{if(selectedProduct){setExistingImages(selectedProduct.images||[]);setSelectedFiles([]);// Clear any selected files from previous state\n}else{// Reset all form-related state when deselecting\nsetExistingImages([]);setSelectedFiles([]);}},[selectedProduct]);// Fetch products\nconst{data:productsData,isLoading,error}=useQuery({queryKey:['adminProducts'],queryFn:()=>productsAPI.getProducts({})});// Add Product Mutation\nconst addProductMutation=useMutation({mutationFn:productsAPI.createProduct,onSuccess:()=>{queryClient.invalidateQueries({queryKey:['adminProducts']});toast.success('Product added successfully!');resetForm();},onError:err=>{var _err$response,_err$response$data;console.error('Error adding product:',err);toast.error(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Failed to add product.');}});// Update Product Mutation\nconst updateProductMutation=useMutation({mutationFn:_ref=>{let{id,productData}=_ref;return productsAPI.updateProduct(id,productData);},onSuccess:()=>{queryClient.invalidateQueries({queryKey:['adminProducts']});toast.success('Product updated successfully!');resetForm();},onError:err=>{var _err$response2,_err$response2$data;console.error('Error updating product:',err);toast.error(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||'Failed to update product.');}});// Delete Product Mutation\nconst deleteProductMutation=useMutation({mutationFn:productsAPI.deleteProduct,onSuccess:()=>{queryClient.invalidateQueries({queryKey:['adminProducts']});toast.success('Product deleted successfully!');},onError:err=>{var _err$response3,_err$response3$data;console.error('Error deleting product:',err);toast.error(((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.message)||'Failed to delete product.');}});const resetForm=()=>{setSelectedProduct(null);setSelectedFiles([]);setExistingImages([]);// This will implicitly clear the form fields because of the `key` prop on the form\n};const handleSubmit=async e=>{var _form$elements$namedI,_form$elements$namedI2,_form$elements$namedI3,_form$elements$namedI4,_form$elements$namedI5,_form$elements$namedI6,_form$elements$namedI7,_form$elements$namedI8;e.preventDefault();const form=e.currentTarget;// Get form reference immediately\nlet uploadedImageUrls=[];// 1. Handle file uploads first\nif(selectedFiles.length>0){setIsUploading(true);const formData=new FormData();selectedFiles.forEach(file=>{formData.append('images',file);});try{const response=await uploadAPI.uploadProductImages(formData);uploadedImageUrls=response.data.imageUrls;toast.success('Images uploaded successfully!');}catch(uploadError){var _uploadError$response,_uploadError$response2;console.error('Image upload failed:',uploadError);toast.error(((_uploadError$response=uploadError.response)===null||_uploadError$response===void 0?void 0:(_uploadError$response2=_uploadError$response.data)===null||_uploadError$response2===void 0?void 0:_uploadError$response2.message)||'Image upload failed.');setIsUploading(false);return;// Stop form submission if upload fails\n}finally{setIsUploading(false);}}// 2. Construct product data with uploaded image URLs by directly accessing form elements\nconst productData={name:((_form$elements$namedI=form.elements.namedItem('name'))===null||_form$elements$namedI===void 0?void 0:_form$elements$namedI.value)||'',description:((_form$elements$namedI2=form.elements.namedItem('description'))===null||_form$elements$namedI2===void 0?void 0:_form$elements$namedI2.value)||'',price:parseFloat(((_form$elements$namedI3=form.elements.namedItem('price'))===null||_form$elements$namedI3===void 0?void 0:_form$elements$namedI3.value)||'0'),category:(_form$elements$namedI4=form.elements.namedItem('category'))===null||_form$elements$namedI4===void 0?void 0:_form$elements$namedI4.value,weight:((_form$elements$namedI5=form.elements.namedItem('weight'))===null||_form$elements$namedI5===void 0?void 0:_form$elements$namedI5.value)||'',stock:parseInt(((_form$elements$namedI6=form.elements.namedItem('stock'))===null||_form$elements$namedI6===void 0?void 0:_form$elements$namedI6.value)||'0',10),images:[...existingImages,...uploadedImageUrls],// Combine existing and new images\norigin:((_form$elements$namedI7=form.elements.namedItem('origin'))===null||_form$elements$namedI7===void 0?void 0:_form$elements$namedI7.value)||'',isActive:((_form$elements$namedI8=form.elements.namedItem('isActive'))===null||_form$elements$namedI8===void 0?void 0:_form$elements$namedI8.checked)||false};// 3. Submit product data to the backend\nif(selectedProduct){updateProductMutation.mutate({id:selectedProduct._id,productData});}else{addProductMutation.mutate(productData);}};const handleDelete=id=>{if(window.confirm('Are you sure you want to delete this product?')){deleteProductMutation.mutate(id);}};const handleFileSelect=e=>{if(e.target.files){const files=Array.from(e.target.files);if(files.length+existingImages.length>5){toast.error('You can upload a maximum of 5 images in total.');return;}setSelectedFiles(prev=>[...prev,...files]);}};const removeSelectedFile=index=>{setSelectedFiles(prev=>prev.filter((_,i)=>i!==index));};const removeExistingImage=index=>{setExistingImages(prev=>prev.filter((_,i)=>i!==index));};if(isLoading)return/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8\",children:\"Loading products...\"});if(error)return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[\"Error loading products: \",error.message]});const isSubmitting=addProductMutation.isPending||updateProductMutation.isPending||isUploading;return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto p-4\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold mb-6\",children:\"Admin Product Management\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white shadow-md rounded-lg p-6 mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold mb-4\",children:\"Existing Products\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 border-b\",children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 border-b\",children:\"Category\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 border-b\",children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 border-b\",children:\"Stock\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 border-b\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:productsData===null||productsData===void 0?void 0:productsData.products.map(product=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 border-b\",children:product.name}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 border-b\",children:product.category}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-2 px-4 border-b\",children:[\"\\u20A6\",product.price.toLocaleString()]}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 border-b\",children:product.stock}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-2 px-4 border-b\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedProduct(product),className:\"bg-blue-500 text-white px-3 py-1 rounded mr-2 hover:bg-blue-600\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(product._id),className:\"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600\",children:\"Delete\"})]})]},product._id))})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white shadow-md rounded-lg p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold mb-4\",children:selectedProduct?'Edit Product':'Add New Product'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"name\",children:\"Product Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"name\",name:\"name\",defaultValue:(selectedProduct===null||selectedProduct===void 0?void 0:selectedProduct.name)||'',className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"category\",children:\"Category\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"category\",name:\"category\",defaultValue:(selectedProduct===null||selectedProduct===void 0?void 0:selectedProduct.category)||'',className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Category\"}),/*#__PURE__*/_jsx(\"option\",{value:\"fresh\",children:\"Fresh\"}),/*#__PURE__*/_jsx(\"option\",{value:\"processed\",children:\"Processed\"}),/*#__PURE__*/_jsx(\"option\",{value:\"seeds\",children:\"Seeds\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"description\",children:\"Description\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"description\",name:\"description\",defaultValue:(selectedProduct===null||selectedProduct===void 0?void 0:selectedProduct.description)||'',className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",rows:3,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"price\",children:\"Price (\\u20A6)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"price\",name:\"price\",defaultValue:(selectedProduct===null||selectedProduct===void 0?void 0:selectedProduct.price)||'',className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",step:\"0.01\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"stock\",children:\"Stock\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"stock\",name:\"stock\",defaultValue:(selectedProduct===null||selectedProduct===void 0?void 0:selectedProduct.stock)||0,className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"weight\",children:\"Weight (e.g., 50kg)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"weight\",name:\"weight\",defaultValue:(selectedProduct===null||selectedProduct===void 0?void 0:selectedProduct.weight)||'',className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"origin\",children:\"Origin\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"origin\",name:\"origin\",defaultValue:(selectedProduct===null||selectedProduct===void 0?void 0:selectedProduct.origin)||'',className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"Product Images\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1 text-center\",children:[/*#__PURE__*/_jsx(UploadCloud,{className:\"mx-auto h-12 w-12 text-gray-400\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex text-sm text-gray-600\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"file-upload\",className:\"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Upload files\"}),/*#__PURE__*/_jsx(\"input\",{id:\"file-upload\",name:\"images\",type:\"file\",className:\"sr-only\",multiple:true,accept:\"image/*\",onChange:handleFileSelect})]}),/*#__PURE__*/_jsx(\"p\",{className:\"pl-1\",children:\"or drag and drop\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"PNG, JPG, GIF up to 10MB\"})]})})]}),(existingImages.length>0||selectedFiles.length>0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"Image Previews\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-4\",children:[existingImages.map((url,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:url,alt:\"Existing product\",className:\"h-24 w-24 object-cover rounded-md\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>removeExistingImage(index),className:\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 leading-none\",children:/*#__PURE__*/_jsx(X,{className:\"w-3 h-3\"})})]},\"existing-\".concat(index))),selectedFiles.map((file,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(file),alt:\"New product\",className:\"h-24 w-24 object-cover rounded-md\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>removeSelectedFile(index),className:\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 leading-none\",children:/*#__PURE__*/_jsx(X,{className:\"w-3 h-3\"})})]},\"new-\".concat(index)))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2 flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"isActive\",name:\"isActive\",defaultChecked:selectedProduct?selectedProduct.isActive:true,className:\"mr-2 h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded\"}),/*#__PURE__*/_jsx(\"label\",{className:\"text-gray-700 text-sm font-bold\",htmlFor:\"isActive\",children:\"Product is Active\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2 flex justify-end gap-4\",children:[selectedProduct&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:resetForm,className:\"bg-gray-400 text-white px-4 py-2 rounded-md hover:bg-gray-500 focus:outline-none focus:shadow-outline\",children:\"Cancel Edit\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:shadow-outline flex items-center disabled:bg-gray-400\",disabled:isSubmitting,children:[isUploading&&/*#__PURE__*/_jsx(Loader2,{className:\"mr-2 h-4 w-4 animate-spin\"}),isUploading?'Uploading...':selectedProduct?'Update Product':'Add Product']})]})]},(selectedProduct===null||selectedProduct===void 0?void 0:selectedProduct._id)||'new')]})]});};export default AdminProducts;","map":{"version":3,"names":["React","useState","useEffect","useQuery","useMutation","useQueryClient","productsAPI","uploadAPI","UploadCloud","X","Loader2","toast","jsx","_jsx","jsxs","_jsxs","AdminProducts","queryClient","selectedProduct","setSelectedProduct","selectedFiles","setSelectedFiles","existingImages","setExistingImages","isUploading","setIsUploading","images","data","productsData","isLoading","error","queryKey","queryFn","getProducts","addProductMutation","mutationFn","createProduct","onSuccess","invalidateQueries","success","resetForm","onError","err","_err$response","_err$response$data","console","response","message","updateProductMutation","_ref","id","productData","updateProduct","_err$response2","_err$response2$data","deleteProductMutation","deleteProduct","_err$response3","_err$response3$data","handleSubmit","e","_form$elements$namedI","_form$elements$namedI2","_form$elements$namedI3","_form$elements$namedI4","_form$elements$namedI5","_form$elements$namedI6","_form$elements$namedI7","_form$elements$namedI8","preventDefault","form","currentTarget","uploadedImageUrls","length","formData","FormData","forEach","file","append","uploadProductImages","imageUrls","uploadError","_uploadError$response","_uploadError$response2","name","elements","namedItem","value","description","price","parseFloat","category","weight","stock","parseInt","origin","isActive","checked","mutate","_id","handleDelete","window","confirm","handleFileSelect","target","files","Array","from","prev","removeSelectedFile","index","filter","_","i","removeExistingImage","className","children","isSubmitting","isPending","products","map","product","toLocaleString","onClick","onSubmit","htmlFor","type","defaultValue","required","rows","step","multiple","accept","onChange","url","src","alt","concat","URL","createObjectURL","defaultChecked","disabled"],"sources":["/home/jaja/Desktop/irish-potatoes/frontend/src/pages/AdminProducts.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { productsAPI, uploadAPI } from '../services/api';\nimport { Product } from '../types';\nimport { UploadCloud, X, Loader2 } from 'lucide-react';\nimport toast from 'react-hot-toast';\n\nconst AdminProducts: React.FC = () => {\n  const queryClient = useQueryClient();\n  const [selectedProduct, setSelectedProduct] = useState<Product | null>(null);\n  const [selectedFiles, setSelectedFiles] = useState<File[]>([]);\n  const [existingImages, setExistingImages] = useState<string[]>([]);\n  const [isUploading, setIsUploading] = useState(false);\n\n  // When a product is selected for editing, populate the form and existing images\n  useEffect(() => {\n    if (selectedProduct) {\n      setExistingImages(selectedProduct.images || []);\n      setSelectedFiles([]); // Clear any selected files from previous state\n    } else {\n      // Reset all form-related state when deselecting\n      setExistingImages([]);\n      setSelectedFiles([]);\n    }\n  }, [selectedProduct]);\n\n  // Fetch products\n  const { data: productsData, isLoading, error } = useQuery({\n    queryKey: ['adminProducts'],\n    queryFn: () => productsAPI.getProducts({}),\n  });\n\n  // Add Product Mutation\n  const addProductMutation = useMutation({\n    mutationFn: productsAPI.createProduct,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['adminProducts'] });\n      toast.success('Product added successfully!');\n      resetForm();\n    },\n    onError: (err: any) => {\n      console.error('Error adding product:', err);\n      toast.error(err.response?.data?.message || 'Failed to add product.');\n    },\n  });\n\n  // Update Product Mutation\n  const updateProductMutation = useMutation({\n    mutationFn: ({ id, productData }: { id: string; productData: Partial<Product> }) =>\n      productsAPI.updateProduct(id, productData),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['adminProducts'] });\n      toast.success('Product updated successfully!');\n      resetForm();\n    },\n    onError: (err: any) => {\n      console.error('Error updating product:', err);\n      toast.error(err.response?.data?.message || 'Failed to update product.');\n    },\n  });\n\n  // Delete Product Mutation\n  const deleteProductMutation = useMutation({\n    mutationFn: productsAPI.deleteProduct,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['adminProducts'] });\n      toast.success('Product deleted successfully!');\n    },\n    onError: (err: any) => {\n      console.error('Error deleting product:', err);\n      toast.error(err.response?.data?.message || 'Failed to delete product.');\n    },\n  });\n\n  const resetForm = () => {\n    setSelectedProduct(null);\n    setSelectedFiles([]);\n    setExistingImages([]);\n    // This will implicitly clear the form fields because of the `key` prop on the form\n  };\n  \n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    const form = e.currentTarget; // Get form reference immediately\n    \n    let uploadedImageUrls: string[] = [];\n\n    // 1. Handle file uploads first\n    if (selectedFiles.length > 0) {\n      setIsUploading(true);\n      const formData = new FormData();\n      selectedFiles.forEach(file => {\n        formData.append('images', file);\n      });\n\n      try {\n        const response = await uploadAPI.uploadProductImages(formData);\n        uploadedImageUrls = response.data.imageUrls;\n        toast.success('Images uploaded successfully!');\n      } catch (uploadError: any) {\n        console.error('Image upload failed:', uploadError);\n        toast.error(uploadError.response?.data?.message || 'Image upload failed.');\n        setIsUploading(false);\n        return; // Stop form submission if upload fails\n      } finally {\n        setIsUploading(false);\n      }\n    }\n\n    // 2. Construct product data with uploaded image URLs by directly accessing form elements\n    const productData: Partial<Product> = {\n      name: (form.elements.namedItem('name') as HTMLInputElement)?.value || '',\n      description: (form.elements.namedItem('description') as HTMLTextAreaElement)?.value || '',\n      price: parseFloat((form.elements.namedItem('price') as HTMLInputElement)?.value || '0'),\n      category: (form.elements.namedItem('category') as HTMLSelectElement)?.value as 'fresh' | 'processed' | 'seeds',\n      weight: (form.elements.namedItem('weight') as HTMLInputElement)?.value || '',\n      stock: parseInt((form.elements.namedItem('stock') as HTMLInputElement)?.value || '0', 10),\n      images: [...existingImages, ...uploadedImageUrls], // Combine existing and new images\n      origin: (form.elements.namedItem('origin') as HTMLInputElement)?.value || '',\n      isActive: (form.elements.namedItem('isActive') as HTMLInputElement)?.checked || false,\n    };\n\n    // 3. Submit product data to the backend\n    if (selectedProduct) {\n      updateProductMutation.mutate({ id: selectedProduct._id, productData });\n    } else {\n      addProductMutation.mutate(productData as Product);\n    }\n  };\n\n  const handleDelete = (id: string) => {\n    if (window.confirm('Are you sure you want to delete this product?')) {\n      deleteProductMutation.mutate(id);\n    }\n  };\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files) {\n      const files = Array.from(e.target.files);\n      if (files.length + existingImages.length > 5) {\n        toast.error('You can upload a maximum of 5 images in total.');\n        return;\n      }\n      setSelectedFiles(prev => [...prev, ...files]);\n    }\n  };\n\n  const removeSelectedFile = (index: number) => {\n    setSelectedFiles(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const removeExistingImage = (index: number) => {\n    setExistingImages(prev => prev.filter((_, i) => i !== index));\n  };\n  \n  if (isLoading) return <div className=\"text-center py-8\">Loading products...</div>;\n  if (error) return <div className=\"text-center py-8\">Error loading products: {(error as Error).message}</div>;\n\n  const isSubmitting = addProductMutation.isPending || updateProductMutation.isPending || isUploading;\n\n  return (\n    <div className=\"container mx-auto p-4\">\n      <h1 className=\"text-3xl font-bold mb-6\">Admin Product Management</h1>\n      \n      {/* Product List */}\n      <div className=\"bg-white shadow-md rounded-lg p-6 mb-8\">\n        <h2 className=\"text-2xl font-semibold mb-4\">Existing Products</h2>\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full bg-white\">\n            <thead>\n              <tr>\n                <th className=\"py-2 px-4 border-b\">Name</th>\n                <th className=\"py-2 px-4 border-b\">Category</th>\n                <th className=\"py-2 px-4 border-b\">Price</th>\n                <th className=\"py-2 px-4 border-b\">Stock</th>\n                <th className=\"py-2 px-4 border-b\">Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {productsData?.products.map((product: Product) => (\n                <tr key={product._id}>\n                  <td className=\"py-2 px-4 border-b\">{product.name}</td>\n                  <td className=\"py-2 px-4 border-b\">{product.category}</td>\n                  <td className=\"py-2 px-4 border-b\">₦{product.price.toLocaleString()}</td>\n                  <td className=\"py-2 px-4 border-b\">{product.stock}</td>\n                  <td className=\"py-2 px-4 border-b\">\n                    <button\n                      onClick={() => setSelectedProduct(product)}\n                      className=\"bg-blue-500 text-white px-3 py-1 rounded mr-2 hover:bg-blue-600\"\n                    >\n                      Edit\n                    </button>\n                    <button\n                      onClick={() => handleDelete(product._id)}\n                      className=\"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600\"\n                    >\n                      Delete\n                    </button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {/* Add/Edit Product Form */}\n      <div className=\"bg-white shadow-md rounded-lg p-6\">\n        <h2 className=\"text-2xl font-semibold mb-4\">\n          {selectedProduct ? 'Edit Product' : 'Add New Product'}\n        </h2>\n        <form key={selectedProduct?._id || 'new'} onSubmit={handleSubmit} className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          \n          {/* Product Name */}\n          <div>\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"name\">\n              Product Name\n            </label>\n            <input\n              type=\"text\"\n              id=\"name\"\n              name=\"name\"\n              defaultValue={selectedProduct?.name || ''}\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              required\n            />\n          </div>\n\n          {/* Category */}\n          <div>\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"category\">\n              Category\n            </label>\n            <select\n              id=\"category\"\n              name=\"category\"\n              defaultValue={selectedProduct?.category || ''}\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              required\n            >\n              <option value=\"\">Select Category</option>\n              <option value=\"fresh\">Fresh</option>\n              <option value=\"processed\">Processed</option>\n              <option value=\"seeds\">Seeds</option>\n            </select>\n          </div>\n\n          {/* Description */}\n          <div className=\"md:col-span-2\">\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"description\">\n              Description\n            </label>\n            <textarea\n              id=\"description\"\n              name=\"description\"\n              defaultValue={selectedProduct?.description || ''}\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              rows={3}\n              required\n            ></textarea>\n          </div>\n\n          {/* Price */}\n          <div>\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"price\">\n              Price (₦)\n            </label>\n            <input\n              type=\"number\"\n              id=\"price\"\n              name=\"price\"\n              defaultValue={selectedProduct?.price || ''}\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              step=\"0.01\"\n              required\n            />\n          </div>\n          \n          {/* Stock */}\n          <div>\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"stock\">\n              Stock\n            </label>\n            <input\n              type=\"number\"\n              id=\"stock\"\n              name=\"stock\"\n              defaultValue={selectedProduct?.stock || 0}\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              required\n            />\n          </div>\n\n          {/* Weight */}\n          <div>\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"weight\">\n              Weight (e.g., 50kg)\n            </label>\n            <input\n              type=\"text\"\n              id=\"weight\"\n              name=\"weight\"\n              defaultValue={selectedProduct?.weight || ''}\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              required\n            />\n          </div>\n\n          {/* Origin */}\n          <div>\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"origin\">\n              Origin\n            </label>\n            <input\n              type=\"text\"\n              id=\"origin\"\n              name=\"origin\"\n              defaultValue={selectedProduct?.origin || ''}\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n            />\n          </div>\n\n          {/* Image Upload */}\n          <div className=\"md:col-span-2\">\n            <label className=\"block text-gray-700 text-sm font-bold mb-2\">Product Images</label>\n            <div className=\"mt-2 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md\">\n              <div className=\"space-y-1 text-center\">\n                <UploadCloud className=\"mx-auto h-12 w-12 text-gray-400\" />\n                <div className=\"flex text-sm text-gray-600\">\n                  <label htmlFor=\"file-upload\" className=\"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500\">\n                    <span>Upload files</span>\n                    <input id=\"file-upload\" name=\"images\" type=\"file\" className=\"sr-only\" multiple accept=\"image/*\" onChange={handleFileSelect} />\n                  </label>\n                  <p className=\"pl-1\">or drag and drop</p>\n                </div>\n                <p className=\"text-xs text-gray-500\">PNG, JPG, GIF up to 10MB</p>\n              </div>\n            </div>\n          </div>\n          \n          {/* Image Previews */}\n          {(existingImages.length > 0 || selectedFiles.length > 0) && (\n            <div className=\"md:col-span-2\">\n              <p className=\"block text-gray-700 text-sm font-bold mb-2\">Image Previews</p>\n              <div className=\"flex flex-wrap gap-4\">\n                {/* Existing Images */}\n                {existingImages.map((url, index) => (\n                  <div key={`existing-${index}`} className=\"relative\">\n                    <img src={url} alt=\"Existing product\" className=\"h-24 w-24 object-cover rounded-md\" />\n                    <button type=\"button\" onClick={() => removeExistingImage(index)} className=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 leading-none\">\n                      <X className=\"w-3 h-3\" />\n                    </button>\n                  </div>\n                ))}\n                {/* New Selected Files */}\n                {selectedFiles.map((file, index) => (\n                  <div key={`new-${index}`} className=\"relative\">\n                    <img src={URL.createObjectURL(file)} alt=\"New product\" className=\"h-24 w-24 object-cover rounded-md\" />\n                    <button type=\"button\" onClick={() => removeSelectedFile(index)} className=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 leading-none\">\n                      <X className=\"w-3 h-3\" />\n                    </button>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n\n          {/* Is Active */}\n          <div className=\"md:col-span-2 flex items-center\">\n            <input\n              type=\"checkbox\"\n              id=\"isActive\"\n              name=\"isActive\"\n              defaultChecked={selectedProduct ? selectedProduct.isActive : true}\n              className=\"mr-2 h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded\"\n            />\n            <label className=\"text-gray-700 text-sm font-bold\" htmlFor=\"isActive\">\n              Product is Active\n            </label>\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"md:col-span-2 flex justify-end gap-4\">\n            {selectedProduct && (\n              <button\n                type=\"button\"\n                onClick={resetForm}\n                className=\"bg-gray-400 text-white px-4 py-2 rounded-md hover:bg-gray-500 focus:outline-none focus:shadow-outline\"\n              >\n                Cancel Edit\n              </button>\n            )}\n            <button\n              type=\"submit\"\n              className=\"bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:shadow-outline flex items-center disabled:bg-gray-400\"\n              disabled={isSubmitting}\n            >\n              {isUploading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n              {isUploading ? 'Uploading...' : (selectedProduct ? 'Update Product' : 'Add Product')}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default AdminProducts;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}