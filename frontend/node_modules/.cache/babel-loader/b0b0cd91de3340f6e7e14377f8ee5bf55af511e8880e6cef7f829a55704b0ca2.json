{"ast":null,"code":"import React from'react';import{useAuth}from'../context/AuthContext';import{useQuery}from'@tanstack/react-query';import{ordersAPI}from'../services/api';import{Link}from'react-router-dom';import{AlertCircle}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UserAccount=()=>{const{user,loading}=useAuth();const{data:orders,isLoading:isLoadingOrders,error:ordersError}=useQuery({queryKey:['userOrders',user===null||user===void 0?void 0:user._id],// Include user ID in query key for invalidation\nqueryFn:ordersAPI.getUsersOrders,enabled:!!user// Only fetch if user is logged in\n});if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8 text-lg\",children:\"Loading user data...\"});}if(!user){return/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8 text-lg text-red-600\",children:\"Please log in to view your account.\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-bold text-gray-800 mb-8 text-center\",children:\"My Account\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-md\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-700 mb-4\",children:\"Profile Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",user.name]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",user.email]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Phone:\"}),\" \",user.phone]}),user.address&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Address:\"}),\" \",user.address.street,\", \",user.address.state,user.address.city&&\", \".concat(user.address.city),user.address.zipCode&&\", \".concat(user.address.zipCode)]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Role:\"}),\" \",user.role]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-md\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-700 mb-4\",children:\"Order History\"}),isLoadingOrders?/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4\",children:\"Loading orders...\"}):ordersError?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-4 text-red-600 flex items-center justify-center\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-5 h-5 mr-2\"}),\" Error loading orders.\"]}):orders&&orders.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:orders.map(order=>/*#__PURE__*/_jsxs(\"div\",{className:\"border border-gray-200 rounded-lg p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold\",children:[\"Order ID: \",order._id.substring(0,8),\"...\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"px-2 py-1 rounded-full text-xs font-medium \".concat(order.status==='pending'?'bg-yellow-100 text-yellow-800':order.status==='processing'?'bg-blue-100 text-blue-800':order.status==='shipped'?'bg-indigo-100 text-indigo-800':order.status==='delivered'?'bg-green-100 text-green-800':'bg-gray-100 text-gray-800'),children:order.status})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"Total: \\u20A6\",order.totalAmount.toLocaleString()]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 text-sm\",children:[\"Ordered on: \",new Date(order.createdAt).toLocaleDateString()]}),/*#__PURE__*/_jsx(Link,{to:\"/order-tracking/\".concat(order._id),className:\"text-blue-600 hover:underline text-sm mt-2 block\",children:\"View Details\"})]},order._id))}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4 text-gray-600\",children:\"No orders found.\"})]})]})]});};export default UserAccount;","map":{"version":3,"names":["React","useAuth","useQuery","ordersAPI","Link","AlertCircle","jsx","_jsx","jsxs","_jsxs","UserAccount","user","loading","data","orders","isLoading","isLoadingOrders","error","ordersError","queryKey","_id","queryFn","getUsersOrders","enabled","className","children","name","email","phone","address","street","state","city","concat","zipCode","role","length","map","order","substring","status","totalAmount","toLocaleString","Date","createdAt","toLocaleDateString","to"],"sources":["/home/jaja/Desktop/irish-potatoes/frontend/src/pages/UserAccount.tsx"],"sourcesContent":["import React from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport { useQuery } from '@tanstack/react-query';\nimport { ordersAPI } from '../services/api';\nimport { Link } from 'react-router-dom';\nimport { AlertCircle } from 'lucide-react';\n\nconst UserAccount: React.FC = () => {\n  const { user, loading } = useAuth();\n\n  const { data: orders, isLoading: isLoadingOrders, error: ordersError } = useQuery({\n    queryKey: ['userOrders', user?._id], // Include user ID in query key for invalidation\n    queryFn: ordersAPI.getUsersOrders,\n    enabled: !!user, // Only fetch if user is logged in\n  });\n\n  if (loading) {\n    return <div className=\"text-center py-8 text-lg\">Loading user data...</div>;\n  }\n\n  if (!user) {\n    return <div className=\"text-center py-8 text-lg text-red-600\">Please log in to view your account.</div>;\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-8\">\n      <h1 className=\"text-4xl font-bold text-gray-800 mb-8 text-center\">My Account</h1>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n        {/* User Profile Section */}\n        <div className=\"bg-white p-6 rounded-lg shadow-md\">\n          <h2 className=\"text-2xl font-bold text-gray-700 mb-4\">Profile Information</h2>\n          <div className=\"space-y-3\">\n            <p className=\"text-gray-600\"><strong>Name:</strong> {user.name}</p>\n            <p className=\"text-gray-600\"><strong>Email:</strong> {user.email}</p>\n            <p className=\"text-gray-600\"><strong>Phone:</strong> {user.phone}</p>\n            {user.address && (\n              <p className=\"text-gray-600\">\n                <strong>Address:</strong> {user.address.street}, {user.address.state}\n                {user.address.city && `, ${user.address.city}`}\n                {user.address.zipCode && `, ${user.address.zipCode}`}\n              </p>\n            )}\n            <p className=\"text-gray-600\"><strong>Role:</strong> {user.role}</p>\n          </div>\n        </div>\n\n        {/* Order History Section */}\n        <div className=\"bg-white p-6 rounded-lg shadow-md\">\n          <h2 className=\"text-2xl font-bold text-gray-700 mb-4\">Order History</h2>\n          {isLoadingOrders ? (\n            <div className=\"text-center py-4\">Loading orders...</div>\n          ) : ordersError ? (\n            <div className=\"text-center py-4 text-red-600 flex items-center justify-center\">\n              <AlertCircle className=\"w-5 h-5 mr-2\" /> Error loading orders.\n            </div>\n          ) : orders && orders.length > 0 ? (\n            <div className=\"space-y-4\">\n              {orders.map((order: any) => (\n                <div key={order._id} className=\"border border-gray-200 rounded-lg p-4\">\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <p className=\"font-semibold\">Order ID: {order._id.substring(0, 8)}...</p>\n                    <p className={`px-2 py-1 rounded-full text-xs font-medium ${\n                        order.status === 'pending' ? 'bg-yellow-100 text-yellow-800' :\n                        order.status === 'processing' ? 'bg-blue-100 text-blue-800' :\n                        order.status === 'shipped' ? 'bg-indigo-100 text-indigo-800' :\n                        order.status === 'delivered' ? 'bg-green-100 text-green-800' :\n                        'bg-gray-100 text-gray-800'\n                      }`}>\n                      {order.status}\n                    </p>\n                  </div>\n                  <p className=\"text-gray-600\">Total: â‚¦{order.totalAmount.toLocaleString()}</p>\n                  <p className=\"text-gray-600 text-sm\">Ordered on: {new Date(order.createdAt).toLocaleDateString()}</p>\n                  <Link to={`/order-tracking/${order._id}`} className=\"text-blue-600 hover:underline text-sm mt-2 block\">\n                    View Details\n                  </Link>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"text-center py-4 text-gray-600\">No orders found.</div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default UserAccount;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}